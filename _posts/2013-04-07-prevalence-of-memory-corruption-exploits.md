---
layout: post
title: Prevalence of memory corruption exploits
categories: []
tags: []
status: publish
type: post
published: true
meta:
  _edit_lock: '1365352210'
  _edit_last: '2'
---
When security folks think of hacking and malware attacks they tend to think of memory corruption exploits as being the common attack vector.  This is a misconception, and I believe will become more of a misconception as defenses improve.

What are memory corruption exploits?  Basically anything that ends up calling shellcode, which means if you see a discussion that involves any of the following terms, they are probably talking about a memory corruption exploit:
<ul>
<li>Buffer overflows
<li>Format string vulnerabilities
<li>Use after free, double-free, heap feng shui
<li>Fuzzing
</ul>

The defenses on Windows for these can be best seen in the BlackHat USA 2012 presentation by Ken Johnson and Matt Miller titled <a href="https://media.blackhat.com/bh-us-12/Briefings/M_Miller/BH_US_12_Miller_Exploit_Mitigation_Slides.pdf">Exploit Mitigation Improvements in Windows 8</a>.  There are two great diagrams there showing the protections against stack and heap vulnerabilities to mitigate the ability to get control of the instruction pointer, and then a slide to show the mitigations in place to get arbitrary code execution even if an attack can control the instruction pointer.

Let's look at some popular worms and exploits and the infection vectors they used.  I tried to choose some of the more famous and notable malware samples (with help from the <a href="http://en.wikipedia.org/wiki/Timeline_of_notable_computer_viruses_and_worms">Timeline of notable computer viruses and worms</a> from wikipedia), with the assumption that these are more popular and have been more successful.  I probably missed some of your favorites (like a lot of Chinese exploits).  Let me know if I missed any infection vectors used by the malware listed or miscategorized them.  Dates represent when the infection first became public.  "Email attachment" means it was simply a .exe (possibly with a different extension) sent in an email.
<table>
<tr><th>Malware<th>Memory Corruption Exploit<th>Other infection vector
<tr><td><b>Morris worm</b>: November 2, 1988<br>First worm.  Infected Unix systems.
  <td>Buffer overflow against finger daemon
  <td>Used rsh and rexec against trusted machines and ones that it could guess passwords for.<br>Used debug mode command of sendmail to infect remote hosts.

<tr><td><b>ILOVEYOU</b>: May 5, 2000<br>.vbs (Visual Basic Script) file sent via email
<td>
<td>Email attachment

<tr><td><b>Sadmind</b>: May 8, 2001<br>Infected both Solaris and Windows web servers
<td><a href="http://www.kb.cert.org/vuls/id/28934">VU#28934</a>: Solaris buffer overflow
<td><a href="http://technet.microsoft.com/en-us/security/bulletin/ms00-078">MS00-078</a>: Directory travel attack on Windows IIS, to simply do something like: "GET /scripts/../../winnt/system32/cmd.exe /c+dir"

<tr><td><b>CodeRed</b>: July 13, 2001<br> Followed up by CodeRed II on August 4, 2001, which used the same infection vector but a different payload.
<td><a href="http://technet.microsoft.com/en-us/security/bulletin/ms01-033">MS01-033</a> Buffer overflow in IIS
<td>

<tr><td><b>Nimda</b>: September 18, 2001<br> Used same infection vectors as Sadmind and CodeRed plus some additional ones.
<td>
<td>Email attachment<br>
Infected all .exe files with itself, so if these copied to other systems, those systems would be infected.<br>
Searched all network shares for any directories containing .DOC and .EML files and then created a hidden "RICHED20.DLL" in that directory that would be loaded via DLL search path hijacking.<br>

<tr><td><b><a href="http://www.f-secure.com/v-descs/mssqlm.shtml">SQL Slammer</a></b>: January 25, 2003<br> Only 376 bytes, it is entirely memory resident (never written to disk).
<td><a href="http://technet.microsoft.com/en-us/security/bulletin/ms02-039">MS02-039</a> SQL Server buffer overflow
<td>

<tr><td><b>Blaster</b>: August 11, 2003<br>Only infected Windows 2000 or Windows XP (32 bit) because the affected program was compiled with the /GS flag in Windows 2003 (did cause crash though).
<td><a href="http://technet.microsoft.com/en-us/security/bulletin/ms03-026">MS03-026</a> DCOM RPC buffer overflow 
<td>

<tr><td><b>Sobig</b>: January 2003
<td>
<td>Email attachment

<tr><td><b>Bagle</b>: January 18, 2004
<td>
<td>Email attachment

<tr><td><b><a href="http://www.f-secure.com/v-descs/novarg.shtml">Mydoom</a></b>: January 26, 2004
<td>
<td>Email attachment<br>Copied itself to Kazaa (file sharing app for you kids reading this) shared directory with the name of an enticing executable

<tr><td><b><a href="http://en.wikipedia.org/wiki/Netsky_(computer_worm)">Netsky</a></b>: January 18, 2004
<td>
<td>Email attachment

<tr><td><b><a href="http://en.wikipedia.org/wiki/Sasser_worm">Sasser</a></b>: April 30, 2004
<td><a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0533">CVE-2003-0533</a> Buffer overflow in LSASS
<td>


<tr><td><b><a href="http://en.wikipedia.org/wiki/Storm_Worm">Storm</a></b>: January 17, 2007
<td>
<td>Email attachment<br>Links to download

<tr><td><b><a href="http://en.wikipedia.org/wiki/Conficker">Conficker</a></b>: November 2008
<td><a href="http://technet.microsoft.com/en-us/security/bulletin/ms08-067">MS08-067</a> RPC handling buffer overflow
<td>Autoruns file for execution from plugged in USB and network shares

<tr><td><b><a href="http://en.wikipedia.org/wiki/Operation_Aurora">Operation Aurora</a></b>: January 12, 2010
<td><a href="http://technet.microsoft.com/en-us/security/bulletin/MS10-002">MS10-002</a> IE memory corruption, see Metasploit <a href="http://www.metasploit.com/modules/exploit/windows/browser/ms10_002_aurora">post</a>
<td>

<tr><td><b><a href="http://en.wikipedia.org/wiki/Stuxnet">Stuxnet</a></b>: June 2010
<td><a href="http://technet.microsoft.com/en-us/security/bulletin/ms08-067">MS08-067</a> Same as used by Conficker<br>
<a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2743">CVE-2010-2743</a> Privilege escalation via Keyboard layout file, see <a href="http://mista.nu/blog/2010/12/01/windows-class-handling-gone-wrong/">this</a> for more.
<td><a href="http://technet.microsoft.com/en-us/security/bulletin/MS10-046">MS10-046</a> LNK file execution on USBs<br>
<a href="http://technet.microsoft.com/en-us/security/bulletin/MS10-061">MS10-061</a> Arbitrary file write via print spooler<br>
<a href="http://technet.microsoft.com/en-us/security/bulletin/MS10-092">MS10-092</a> Privilege escalation via Task Scheduler due to CRC32 hash collision of a file<br>
<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2772">CVE-2010-2772</a>, <a href="https://www.siemens.com/corporate-technology/pool/de/forschungsfelder/siemens_security_advisory_ssa-027884.pdf">SSA-027884</a>: Default passwords for SQL Server<br>
<a href="https://www.siemens.com/corporate-technology/pool/de/forschungsfelder/siemens_security_advisory_ssa-110665.pdf">SSA-110665</a> DLL Hijacking of Step7 software when loading .s7p files

<tr><td><b><a href="http://en.wikipedia.org/wiki/Duqu">Duqu</a></b>: September 1, 2011<br>
.doc file
<td><a href="http://technet.microsoft.com/en-us/security/bulletin/ms11-087">MS11-087</a> True Type Font integer overflow
<td>

<tr><td><b><a href="http://www.f-secure.com/weblog/archives/00002341.html">Flashback</a></b>: April 2, 2012<br>
Mac malware, infection vectors identified by <a href="https://www.securelist.com/en/analysis/204792227/The_anatomy_of_Flashfake_Part_1">Kaspersky</a>
<td>
<td>Fake download<br>
<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5353">CVE-2008-5353</a> <a href="http://blog.cr0.org/2009/05/write-once-own-everyone.html">Deserialization issue</a><br>
<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3544">CVE-2011-3544</a> Custom toString allowing privileged execution of Java, see Metasploit <a href="http://www.metasploit.com/svn/framework3/trunk/external/source/exploits/CVE-2011-3544/Exploit.java">code</a><br>
<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0507">CVE-2012-0507</a> Logic flaw in handling array (not memory corruption according to <a href="http://blogs.technet.com/b/mmpc/archive/2012/03/20/an-interesting-case-of-jre-sandbox-breach-cve-2012-0507.aspx">technet post</a>)



<tr><td><b><a href="http://en.wikipedia.org/wiki/Flame_(malware)">Flame</a></b>: May 28, 2012<br>See <a href="http://www.crysys.hu/skywiper/skywiper.pdf">CrySyS report</a>
<td>
<td><a href="http://technet.microsoft.com/en-us/security/advisory/2718704">KB 2718704</a> Windows update flaw, more info <a href="http://www.symantec.com/connect/blogs/w32flamer-microsoft-windows-update-man-middle">here</a><br>
<a href="http://technet.microsoft.com/en-us/security/bulletin/MS10-046">MS10-046</a> LNK file execution on USBs<br>
<a href="http://technet.microsoft.com/en-us/security/bulletin/MS10-061">MS10-061</a> Arbitrary file write via print spooler

<tr><td><b><a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/the-number-of-the-beast.html">Miniduke</a></b>: February 13, 2013<br>
.doc file
<td><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0640">CVE-2013-0640</a> PDF exploit
<td>


</table>

I compiled this list to allow people to see the types of attacks EMET protects against ("Memory Corruption Exploits") and all the threats it does <b>nothing</b> against.  I think EMET and the rest of the protections Microsoft has implemented on the OS and within Visual Studio to thwart memory corruption exploits are amazing and important, but never lose sight of the forest for the trees.  There are other threats that are not memory corruption exploits, and as these protections become prevalent (become the default without the need for EMET), the memory corruption exploits will become less prevalent.  Almost all of the threats on the right hand side can be thwarted by proper white-listing (the exception is the default SQL Server password vulnerability used by Stuxnet).
